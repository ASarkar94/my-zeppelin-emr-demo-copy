{
  "paragraphs": [
    {
      "title": "Zeppelin Demo Notebook 2",
      "text": "%md\nDemonstrate loading, querying, visualizing, and saving the GroupLens MovieLens Latest Datasets.\nThe latest datasets are available to download on [GroupLens](https://grouplens.org/datasets/movielens/).\n\nMovieLens Datasets Specifications:\n- Small: __100,000__ ratings and 3,600 tag applications applied to 9,000 movies by 600 users. Last updated 9/2018.\n- Full: __27,000,000__ ratings and 1,100,000 tag applications applied to 58,000 movies by 280,000 users. Includes tag genome data with 14 million relevance scores across 1,100 tags. Last updated 9/2018.",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:52:28.690",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eDemonstrate loading, querying, visualizing, and saving the GroupLens MovieLens Latest Datasets.\u003cbr/\u003eThe latest datasets are available to download on \u003ca href\u003d\"https://grouplens.org/datasets/movielens/\"\u003eGroupLens\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eMovieLens Datasets Specifications:\u003cbr/\u003e- Small: \u003cstrong\u003e100,000\u003c/strong\u003e ratings and 3,600 tag applications applied to 9,000 movies by 600 users. Last updated 9/2018.\u003cbr/\u003e- Full: \u003cstrong\u003e27,000,000\u003c/strong\u003e ratings and 1,100,000 tag applications applied to 58,000 movies by 280,000 users. Includes tag genome data with 14 million relevance scores across 1,100 tags. Last updated 9/2018.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1573161585787_1398568692",
      "id": "20191106-153644_419077851",
      "dateCreated": "2019-11-07 21:19:45.788",
      "dateStarted": "2019-11-10 07:52:28.701",
      "dateFinished": "2019-11-10 07:52:28.706",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Import Python Packages",
      "text": "%spark.pyspark\nfrom pyspark import SparkFiles\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType, DateType",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:52:28.801",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1573161585794_-369410071",
      "id": "20191009-042517_1466963465",
      "dateCreated": "2019-11-07 21:19:45.794",
      "dateStarted": "2019-11-10 07:52:28.818",
      "dateFinished": "2019-11-10 07:52:28.821",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Create Spark Session",
      "text": "%spark.pyspark\nspark \u003d SparkSession \\\n    .builder \\\n    .appName(\"pyspark_demo_app\") \\\n    .getOrCreate()",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:52:28.917",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": [
          {}
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1573161585794_630658218",
      "id": "20191009-042751_2109019779",
      "dateCreated": "2019-11-07 21:19:45.795",
      "dateStarted": "2019-11-10 07:52:28.929",
      "dateFinished": "2019-11-10 07:52:28.933",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Notebook Variables",
      "text": "%spark.pyspark\nDATA_BUCKET\u003d\"s3://gstafford-aws-emr-notebooks/output/\"",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:54:03.432",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1573371006967_-377668910",
      "id": "20191110-073006_882260902",
      "dateCreated": "2019-11-10 07:30:06.967",
      "dateStarted": "2019-11-10 07:52:29.041",
      "dateFinished": "2019-11-10 07:52:29.044",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Load MovieLens Data from GroupLens",
      "text": "%sh\nDIR\u003d\"ml-latest-small\" # ml-latest or ml-latest-small\nif [ -d $DIR ]; then\n    echo \"$DIR exist\"\nelse \n    wget -nv http://files.grouplens.org/datasets/movielens/$DIR.zip \u0026\u0026 unzip $DIR.zip\nfi\n\nls -alh $DIR\n\n# copy from local file system (/var/lib/zeppelin) to the destination file system (/user/zeppelin)\nhadoop fs -put -f  $DIR/movies.csv $DIR/ratings.csv .\necho\nhadoop fs -ls -h *.csv",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:54:03.441",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "selectedInterpreter": {
          "name": "python",
          "profile": "python",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.python.PythonInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sh",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {
          "HADOOP_HOME": ""
        },
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": " exist\ntotal 960K\ndrwxr-xr-x  6 zeppelin zeppelin  126 Nov 10 06:37 .\ndrwxr-xr-x 45 hadoop   hadoop   4.0K Nov 10 06:50 ..\ndrwx------  3 zeppelin zeppelin   17 Nov 10 05:42 .cache\ndrwxr-xr-x  3 zeppelin zeppelin   35 Nov 10 05:29 local-repo\ndrwxr-xr-x  2 zeppelin zeppelin   94 Sep 26  2018 ml-latest-small\n-rw-r--r--  1 zeppelin zeppelin 956K May  8  2019 ml-latest-small.zip\ndrwx------  3 zeppelin zeppelin   23 Nov 10 05:29 notebook\n-rw-------  1 zeppelin zeppelin    0 Nov 10 05:42 .scala_history\nput: `/movies.csv\u0027: No such file or directory\nput: `/ratings.csv\u0027: No such file or directory\n\n-rw-r--r--   1 zeppelin hadoop    482.8 K 2019-11-10 07:22 movies.csv\n-rw-r--r--   1 zeppelin hadoop      2.4 M 2019-11-10 07:22 ratings.csv\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1573161585795_2012219506",
      "id": "20191009-042907_1768707497",
      "dateCreated": "2019-11-07 21:19:45.795",
      "dateStarted": "2019-11-10 07:52:29.151",
      "dateFinished": "2019-11-10 07:52:32.837",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Load CSV Data into DataFrame",
      "text": "%spark.pyspark\nratingsDF \u003d spark.read \\\n    .format(\"csv\") \\\n    .option(\"header\", \"true\") \\\n    .option(\"delimiter\", \",\") \\\n    .option(\"inferSchema\", \"true\") \\\n    .load(\"ratings.csv\")\n\nratingsDF.show(10, False)\nprint ratingsDF.count()\nprint ratingsDF",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:52:32.852",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 355.0,
              "optionOpen": false
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-------+------+---------+\n|userId|movieId|rating|timestamp|\n+------+-------+------+---------+\n|1     |1      |4.0   |964982703|\n|1     |3      |4.0   |964981247|\n|1     |6      |4.0   |964982224|\n|1     |47     |5.0   |964983815|\n|1     |50     |5.0   |964982931|\n|1     |70     |3.0   |964982400|\n|1     |101    |5.0   |964980868|\n|1     |110    |4.0   |964982176|\n|1     |151    |5.0   |964984041|\n|1     |157    |5.0   |964984100|\n+------+-------+------+---------+\nonly showing top 10 rows\n\n100836\nDataFrame[userId: int, movieId: int, rating: double, timestamp: int]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d292",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d293",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d294",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d295"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1573161585796_1293011902",
      "id": "20191009-044129_2035687603",
      "dateCreated": "2019-11-07 21:19:45.796",
      "dateStarted": "2019-11-10 07:52:32.863",
      "dateFinished": "2019-11-10 07:52:42.546",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Create Temporary View of Data and Query",
      "text": "%spark.pyspark\n\nratingsDF.createOrReplaceTempView(\"ratings\")\n\nratingsDF \u003d spark.sql(\"SELECT movieId, rating, userId, CAST(timestamp as timestamp) as dateTime \" +\n                      \"FROM ratings \" +\n                      \"ORDER BY movieId, rating, userId\")\n\nratingsDF.show(10, False)\nratingsDF.count()",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:52:42.570",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------+------+-------------------+\n|movieId|rating|userId|dateTime           |\n+-------+------+------+-------------------+\n|1      |0.5   |76    |2015-08-10 00:12:28|\n|1      |1.5   |462   |2006-07-27 22:00:53|\n|1      |2.0   |132   |2006-09-10 20:56:25|\n|1      |2.0   |153   |2018-05-05 19:30:42|\n|1      |2.0   |193   |2015-07-02 17:08:10|\n|1      |2.0   |266   |1999-12-20 05:59:02|\n|1      |2.0   |298   |2015-11-14 16:24:17|\n|1      |2.0   |412   |1999-10-05 09:05:53|\n|1      |2.5   |15    |2017-11-13 12:59:30|\n|1      |2.5   |68    |2006-09-17 22:17:06|\n+-------+------+------+-------------------+\nonly showing top 10 rows\n\n100836\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d296",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d297",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d298"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1573161585796_891183216",
      "id": "20191009-050109_648011188",
      "dateCreated": "2019-11-07 21:19:45.797",
      "dateStarted": "2019-11-10 07:52:42.583",
      "dateFinished": "2019-11-10 07:52:47.050",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Save as Parquet to S3",
      "text": "%spark.pyspark\nratingsDF.write.parquet(DATA_BUCKET + \"ratings.parquet\", mode\u003d\"overwrite\")\nratingsDF \u003d spark.read.parquet(DATA_BUCKET + \"ratings.parquet\")\nratingsDF.count()",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:52:47.096",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "100836\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d299",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d300",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d301",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d302"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1573364755638_1580655931",
      "id": "20191110-054555_1490759128",
      "dateCreated": "2019-11-10 05:45:55.638",
      "dateStarted": "2019-11-10 07:52:47.124",
      "dateFinished": "2019-11-10 07:53:17.803",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Load CSV Data into DataFrame",
      "text": "%spark.pyspark\nmoviesDF \u003d spark.read \\\n    .format(\"csv\") \\\n    .option(\"header\", \"true\") \\\n    .option(\"delimiter\", \",\") \\\n    .option(\"inferSchema\", \"true\") \\\n    .load(\"movies.csv\")\n\nmoviesDF.show(10, False)\nprint moviesDF.count()\nprint moviesDF",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:53:17.888",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+----------------------------------+-------------------------------------------+\n|movieId|title                             |genres                                     |\n+-------+----------------------------------+-------------------------------------------+\n|1      |Toy Story (1995)                  |Adventure|Animation|Children|Comedy|Fantasy|\n|2      |Jumanji (1995)                    |Adventure|Children|Fantasy                 |\n|3      |Grumpier Old Men (1995)           |Comedy|Romance                             |\n|4      |Waiting to Exhale (1995)          |Comedy|Drama|Romance                       |\n|5      |Father of the Bride Part II (1995)|Comedy                                     |\n|6      |Heat (1995)                       |Action|Crime|Thriller                      |\n|7      |Sabrina (1995)                    |Comedy|Romance                             |\n|8      |Tom and Huck (1995)               |Adventure|Children                         |\n|9      |Sudden Death (1995)               |Action                                     |\n|10     |GoldenEye (1995)                  |Action|Adventure|Thriller                  |\n+-------+----------------------------------+-------------------------------------------+\nonly showing top 10 rows\n\n9742\nDataFrame[movieId: int, title: string, genres: string]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d303",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d304",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d305",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d306"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1573170957319_-724857282",
      "id": "20191107-235557_158160591",
      "dateCreated": "2019-11-07 23:55:57.319",
      "dateStarted": "2019-11-10 07:53:17.903",
      "dateFinished": "2019-11-10 07:53:19.846",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Save as Parquet to S3",
      "text": "%spark.pyspark\nmoviesDF.write.parquet(DATA_BUCKET + \"movies.parquet\", mode\u003d\"overwrite\")\nmoviesDF \u003d spark.read.parquet(DATA_BUCKET + \"movies.parquet\")\nmoviesDF.count()",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:53:19.908",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "9742\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d307",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d308",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d309"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1573364882403_-409250558",
      "id": "20191110-054802_1565191258",
      "dateCreated": "2019-11-10 05:48:02.403",
      "dateStarted": "2019-11-10 07:53:19.921",
      "dateFinished": "2019-11-10 07:53:22.358",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Replace Temporary View with New Query",
      "text": "%spark.pyspark\nratingsDF.createOrReplaceTempView(\"ratings\")\nmoviesDF.createOrReplaceTempView(\"movies\")\n\ntopMoviesDF \u003d spark.sql(\"SELECT m.title, AVG(r.rating) as avg_rating, COUNT(r.rating) as cnt_ratings \" +\n                        \"FROM ratings r \" +\n                        \"JOIN movies m ON (r.movieId \u003d m.movieId) \" +\n                        \"GROUP BY m.title \" +\n                        \"ORDER BY avg_rating DESC, cnt_ratings DESC, m.title ASC\")\n                        \n# topMoviesDF \u003d topMoviesDF.filter(topMoviesDF.cnt_ratings \u003e\u003d 25)\n\nprint \"Top 10 Movies\"\ntopMoviesDF.show(10, False)\ntopMoviesDF.count()",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 08:10:43.178",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Top 10 Movies\n+---------------------------------------------+-----------------+-----------+\n|title                                        |avg_rating       |cnt_ratings|\n+---------------------------------------------+-----------------+-----------+\n|Shawshank Redemption, The (1994)             |4.429022082018927|317        |\n|Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)|4.333333333333333|27         |\n|Philadelphia Story, The (1940)               |4.310344827586207|29         |\n|Lawrence of Arabia (1962)                    |4.3              |45         |\n|In the Name of the Father (1993)             |4.3              |25         |\n|Hoop Dreams (1994)                           |4.293103448275862|29         |\n|Godfather, The (1972)                        |4.2890625        |192        |\n|Harold and Maude (1971)                      |4.288461538461538|26         |\n|Logan (2017)                                 |4.28             |25         |\n|Fight Club (1999)                            |4.272935779816514|218        |\n+---------------------------------------------+-----------------+-----------+\nonly showing top 10 rows\n\n1050\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d327",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d328",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d329",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d330",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d331"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1573161585797_-394721398",
      "id": "20191009-050155_2142326603",
      "dateCreated": "2019-11-07 21:19:45.797",
      "dateStarted": "2019-11-10 08:09:14.233",
      "dateFinished": "2019-11-10 08:10:03.511",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Native Zeppelin Visualization Based on SQL Query",
      "text": "%sql\nWITH tmp_table AS (\n    SELECT m.title, AVG(r.rating) as avg_rating, COUNT(r.rating) as cnt_ratings\n    FROM ratings r\n    JOIN movies m ON (r.movieId \u003d m.movieId)\n    GROUP BY m.title)\n    \nSELECT title, CAST(avg_rating AS DECIMAL(38,2)), cnt_ratings\nFROM tmp_table\nWHERE avg_rating \u003e\u003d ${avgRatingMin\u003d4} AND cnt_ratings \u003e\u003d ${RatingsMin\u003d2}\nORDER BY avg_rating ASC, cnt_ratings DESC, title ASC\nLIMIT 25",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:54:03.668",
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sql",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 419.641,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "title": "string",
                      "avg_rating": "string",
                      "ratings": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": true
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "pieChart": {},
                "scatterChart": {
                  "yAxis": {
                    "name": "avg_rating",
                    "index": 1.0,
                    "aggr": "sum"
                  },
                  "xAxis": {
                    "name": "cnt_ratings",
                    "index": 2.0,
                    "aggr": "sum"
                  },
                  "group": {
                    "name": "title",
                    "index": 0.0,
                    "aggr": "sum"
                  }
                }
              },
              "keys": [
                {
                  "name": "avg_rating",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ],
              "groups": [
                {
                  "name": "title",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "values": [
                {
                  "name": "cnt_ratings",
                  "index": 2.0,
                  "aggr": "sum"
                }
              ],
              "commonSetting": {}
            },
            "helium": {}
          },
          "1": {
            "graph": {
              "mode": "table",
              "height": 86.0,
              "optionOpen": false
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {
          "avgRating": "4",
          "avgRatingMin": "4",
          "ratingMin": "2",
          "RatingsMin": "100"
        },
        "forms": {
          "avgRatingMin": {
            "type": "TextBox",
            "name": "avgRatingMin",
            "defaultValue": "4",
            "hidden": false
          },
          "RatingsMin": {
            "type": "TextBox",
            "name": "RatingsMin",
            "defaultValue": "2",
            "hidden": false
          }
        }
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "title\tavg_rating\tcnt_ratings\nBeautiful Mind, A (2001)\t4.00\t123\nUp (2009)\t4.00\t105\nLord of the Rings: The Two Towers, The (2002)\t4.02\t188\nLéon: The Professional (a.k.a. The Professional) (Léon) (1994)\t4.02\t133\nBraveheart (1995)\t4.03\t237\nBack to the Future (1985)\t4.04\t171\nTrainspotting (1996)\t4.04\t102\nIndiana Jones and the Last Crusade (1989)\t4.05\t140\nAmerican Beauty (1999)\t4.06\t204\nWALL·E (2008)\t4.06\t104\nInception (2010)\t4.07\t143\nGood Will Hunting (1997)\t4.08\t141\nShining, The (1980)\t4.08\t109\nBlade Runner (1982)\t4.10\t124\nFull Metal Jacket (1987)\t4.10\t102\nLord of the Rings: The Fellowship of the Ring, The (2001)\t4.11\t198\nTaxi Driver (1976)\t4.11\t104\nLord of the Rings: The Return of the King, The (2003)\t4.12\t185\nFargo (1996)\t4.12\t181\nMemento (2000)\t4.12\t159\nStar Wars: Episode VI - Return of the Jedi (1983)\t4.14\t196\nSaving Private Ryan (1998)\t4.15\t188\nGreen Mile, The (1999)\t4.15\t111\nForrest Gump (1994)\t4.16\t329\nSilence of the Lambs, The (1991)\t4.16\t279\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d315",
            "http://ip-172-31-2-238.ec2.internal:4040/jobs/job?id\u003d316"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1573161585798_1054325402",
      "id": "20191106-042245_200419154",
      "dateCreated": "2019-11-07 21:19:45.798",
      "dateStarted": "2019-11-10 07:53:51.201",
      "dateFinished": "2019-11-10 07:54:03.358",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n",
      "user": "anonymous",
      "dateUpdated": "2019-11-10 07:54:03.422",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1573191088991_-765507571",
      "id": "20191108-053128_1591075156",
      "dateCreated": "2019-11-08 05:31:28.991",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "demo-zeppelin-nb-02",
  "id": "2EUZKQXX7",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "sh:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}